<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Orienteering</title>
    <script src="js/jspsych.js"></script>
    <script src="js/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="js/plugins/jspsych-external-html.js"></script>
    <script src="js/plugins/jspsych-instructions.js"></script>
    <link href="js/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
  </head>
  <body>
  </body>
  <script>
    
// #################  create timeline  #################
var timeline = [];  // The last thing we do is to run it!


// #################  The demographics screen  #################
var check_consent = function(elem) {
      // get the value of a radio button
        function getRadioButton(name) {
            var i, radios = document.getElementsByName(name);
            for (i = 0; i < radios.length; i = i + 1) {
                if (radios[i].checked) {
                    return (radios[i].value);
                }
            }
            return("NA")
        }

        jsPsych.data.addProperties( {
	    gender: getRadioButton("gender"),
        age: document.getElementById("age").value,
        language: document.getElementById("language").value,
        country: document.getElementById("country").value,
        experience: getRadioButton("experience").value,
        handedness: getRadioButton("handedness").value,
        mapholding: getRadioButton("mapholding").value,
        })

        // Now check to ensure that we have valid inforamtion in all fields
};

        
// generate a random subject ID with 15 characters
var subject_id = jsPsych.randomization.randomID(15);

// pick a random condition for the subject at the start of the experiment
var condition_assignment = jsPsych.randomization.sampleWithoutReplacement(['conditionA', 'conditionB', 'conditionC'], 1)[0];

// record the condition assignment in the jsPsych data
// this adds a property called 'subject' and a property called 'condition' to every trial
jsPsych.data.addProperties({
  subject: subject_id,
  condition: condition_assignment


    });

    var introduction = {
      type:'external-html',
      url: "demographics_page.html",
      cont_btn: "demographics_done",
      check_fn: check_consent
      };


var debrief = {
          type: "html-keyboard-response",
          stimulus: function() {
            var first_one = jsPsych.data.get().filter({id: "subject_id"});
            return "<p style='font-size:25px'>Age<strong>" + first_one + "ms</strong>.</p>";
          }
        };

    timeline.push(introduction);  // Into the timeline
    timeline.push(debrief);  // Into the timeline

 // #################  run timeline  #################
    jsPsych.init ({
        timeline: timeline,  // Oooh yes, now we run the time line
        on_finish: function() {
            jsPsych.data.displayData();
        }
    });


   </script>
</html>
